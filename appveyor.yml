clone_folder: C:\ssl-vision
shallow_clone: true

environment:
  global:
    MSYS_DIR: C:\msys64
  matrix:
    - platform: x86
      platform_name: i686
      bit: 32
    - platform: x64
      platform_name: x86_64
      bit: 64     

init:
  - set PATH=%MSYS_DIR%\usr\bin
  - pacman --noconfirm -Su mingw%bit%/mingw-w64-%platform_name%-gcc
  - pacman --noconfirm -Su mingw%bit%/mingw-w64-%platform_name%-make
  - pacman --noconfirm -Su mingw%bit%/mingw-w64-%platform_name%-qt5
  - pacman --noconfirm -Su mingw%bit%/mingw-w64-%platform_name%-protobuf
  - pacman --noconfirm -Su mingw%bit%/mingw-w64-%platform_name%-pkg-config
  - pacman --noconfirm -Su mingw%bit%/mingw-w64-%platform_name%-eigen3
  - pacman --noconfirm -Su mingw%bit%/mingw-w64-%platform_name%-cmake

build_script:
  - set PATH=%MSYS_DIR%\mingw%bit%\bin;%MSYS_DIR%\mingw%bit%\lib
  - echo %PATH%
  - protoc.exe --version
  - dir %MSYS_DIR%\mingw%bit%\lib
  - mkdir C:\build_mingw_%platform%
  - cd C:\build_mingw_%platform%
  - cmake.exe -G "MinGW Makefiles" C:\ssl-vision
  - cmake.exe --build . -j 4
